{% extends 'base.html' %}

{% block header %}
  <h3>{% block title %}添加员工{% endblock %}</h3>
  <hr>
{% endblock %}

{% block content %}
  <form method='POST'>
    <div class='form-group'>
      <label for='username'>用户名</label>
      <input class='form-control col-3' name='username' id='username' required>
    </div>
    <div class='form-group'>
      <label for='realname'>姓名</label>
      <input class='form-control col-3' name='realname' id='realname'>
    </div>
    <div class='form-group'>
      <label for='dept'>部门</label>
      <select class='form-control col-3' name='dept' id='dept'>
        <option disabled selected value> -- select a department -- </option>
        {% for dept in depts %}
          <option value="{{ dept['id'] }}">{{ dept['dept_name'] }}</option>
        {% endfor %}
      </select>
    </div>
    {% if g.user['id'] == 0 %}
      <div class='form-group'>
        <label for='type'>类型</label>
        <select class='form-control col-3' name='type' id='type'>
          <option disabled selected value> -- select type -- </option>
          <option value='0'>一般员工</option>
          <option value='1'>管理员</option>
        </select>
      </div>
      <script>
        $(function () {
          $('#type').on('change', function () {
            if ($('#type').val() == 0) {
              $('#permission-selector').attr('hidden', true);
            } else {
              $('#permission-selector').attr('hidden', false);
            };
          });
        });
      </script>
      <div class='form-group' id='permission-selector' hidden>
        <label for='permission'>权限</label>
        <select multiple class='form-control col-3' name='permission' id='permission'>
          {% for dept in depts %}
            <option value="{{ dept['id'] }}">{{ dept['dept_name'] }}</option>
          {% endfor %}
        </select>
      </div>
    {% endif %}
    <input type='submit' value='添加' class='btn btn-primary'>
    <a class='btn btn-primary' href='javascript:history.go(-1);'>取消</a>
  </form>
{% endblock %}
